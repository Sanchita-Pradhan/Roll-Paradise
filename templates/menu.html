{% extends "base.html" %}
{% block title %}Our Menu - Roll Paradise{% endblock %}

{% block content %}
<!-- Menu Hero Section -->
<section class="menu-hero animated-hero-bg">
  <div class="container hero-content" style="padding: 5rem 0 3rem 0; text-align:center; position:relative; z-index:2;">
    <div class="hero-badge" style="margin-bottom:2rem;">
      <span class="badge-icon" style="font-size:1.3rem;">üåØ</span>
      SIGNATURE ROLLS &amp; MORE
    </div>
    <h1 class="hero-title" style="font-size:3.5rem; font-weight:900; color:white; text-shadow:2px 2px 8px rgba(102,126,234,0.15); animation:fadeInDown 1.2s;">
      Our Delicious Menu
    </h1>
    <p class="hero-subtitle" style="color:#f8f9ff; font-size:1.25rem; margin:1.5rem auto 2.5rem; max-width:600px; animation:fadeInUp 1.2s;">
      Discover our handcrafted rolls, fresh sides, and refreshing drinks. Build your own or try our chef‚Äôs specials!
    </p>
    <!-- Animated Features Row -->
    <div class="hero-features" style="margin:2.5rem 0 1rem 0;">
      <div class="feature-item" style="animation: popIn 1s 0.2s both;">
        <i class="fas fa-leaf"></i>
        Fresh Ingredients
      </div>
      <div class="feature-item" style="animation: popIn 1s 0.4s both;">
        <i class="fas fa-palette"></i>
        Customizable
      </div>
      <div class="feature-item" style="animation: popIn 1s 0.6s both;">
        <i class="fas fa-star"></i>
        Chef's Special
      </div>
    </div>
    <!-- Scroll Down Indicator removed -->
  </div>
  <!-- Animated floating food icons -->
  <div class="floating-foods">
    <span class="floating-food food-1">üåØ</span>
    <span class="floating-food food-2">ü•ó</span>
    <span class="floating-food food-3">üçõ</span>
    <span class="floating-food food-4">ü•ô</span>
    <span class="floating-food food-5">ü•í</span>
    <span class="floating-food food-6">üçü</span>
  </div>
  <!-- Animated bubbles background -->
  <div class="bubbles-bg">
    {% for i in range(12) %}
      <div
        class="bubble"
        style="
          left:{{ (i*8 + (i%2==0 and 4 or -4))%100 }}%;
          animation-delay: {{ (i*0.3)|round(2) }}s;
          animation-duration: {{ 7 + (i%5) }}s;
        ">
      </div>
    {% endfor %}
  </div>
</section>

<!-- Search and Filter Section -->
<section class="menu-filters">
    <div class="container">
        <div class="filters-wrapper">
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="menu-search" placeholder="Search for your favorite rolls..." value="{{ search_query }}">
                <button class="search-btn" onclick="searchMenu()">
                    <i class="fas fa-search"></i>
                </button>
            </div>
            
            <div class="category-filters">
                <button class="category-btn {% if current_category == 'all' %}active{% endif %}" 
                        data-category="all" onclick="filterByCategory('all')">
                    <i class="fas fa-utensils"></i>
                    All Items
                </button>
                {% for category in categories %}
                {% if category != 'all' %}
                <button class="category-btn {% if current_category == category %}active{% endif %}" 
                        data-category="{{ category }}" onclick="filterByCategory('{{ category }}')">
                    <i class="fas fa-{% if category == 'chicken' %}drumstick-bite{% elif category == 'beef' %}hamburger{% elif category == 'vegetarian' %}leaf{% elif category == 'pork' %}bacon{% elif category == 'seafood' %}fish{% else %}utensils{% endif %}"></i>
                    {{ category|title }}
                </button>
                {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<!-- Featured Rolls Section -->
<section class="menu-section featured-rolls">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-star"></i>
                Featured Rolls
            </h2>
            <p class="section-subtitle">Our most popular and delicious signature rolls</p>
        </div>
        
        <div class="menu-grid" id="rolls-grid">
            {% for roll in rolls %}
            <div class="menu-item roll-item" data-category="{{ roll.category }}" data-name="{{ roll.name|lower }}">
                <div class="item-image-container">
                    <img src="{{ roll.image }}" alt="{{ roll.name }}" class="item-image" 
                         onerror="this.onerror=null;this.src='/static/images/placeholder.png';">
                    {% if roll.popular %}
                    <div class="popular-badge">
                        <i class="fas fa-fire"></i>
                        Popular
                    </div>
                    {% endif %}
                </div>
                
                <div class="item-content">
                    <div class="item-header">
                        <h3 class="item-name">{{ roll.name }}</h3>
                        <div class="item-rating">
                            <div class="stars">
                                {% for i in range(5) %}
                                <i class="fas fa-star {% if i < roll.rating|int %}filled{% endif %}"></i>
                                {% endfor %}
                            </div>
                            <span class="rating-text">{{ roll.rating }}</span>
                        </div>
                    </div>
                    
                    <p class="item-description">{{ roll.description }}</p>
                    
                    <div class="item-details">
                        <div class="detail-tags">
                            {% if roll.spicy_level > 0 %}
                            <span class="tag spicy-tag">
                                <i class="fas fa-pepper-hot"></i>
                                {% for i in range(roll.spicy_level) %}üî•{% endfor %}
                            </span>
                            {% endif %}
                            <span class="tag calories-tag">
                                <i class="fas fa-fire"></i>
                                {{ roll.calories }} cal
                            </span>
                            <span class="tag time-tag">
                                <i class="fas fa-clock"></i>
                                {{ roll.prep_time }}
                            </span>
                        </div>
                    </div>
                    
                    <div class="item-footer">
                        <div class="item-price">‚Çπ{{ '%.2f'|format(roll.price) }}</div>
                        <button class="add-to-cart-btn" onclick="addToCart('{{ roll.id }}', 'roll', '{{ roll.name }}', {{ roll.price }})">
                            <i class="fas fa-plus"></i>
                            Add to Cart
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Sides Section -->
<section class="menu-section sides-section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-french-fries"></i>
                Fresh Sides
            </h2>
            <p class="section-subtitle">Perfect accompaniments to complement your roll</p>
        </div>
        
        <div class="menu-grid sides-grid">
            {% for side in sides %}
            <div class="menu-item side-item">
                <div class="item-image-container">
                    <img src="{{ side.image }}" alt="{{ side.name }}" class="item-image"
                         onerror="this.onerror=null;this.src='/static/images/placeholder.png';">
                </div>
                
                <div class="item-content">
                    <h3 class="item-name">{{ side.name }}</h3>
                    
                    <div class="item-footer">
                        <div class="item-price">‚Çπ{{ '%.2f'|format(side.price) }}</div>
                        <button class="add-to-cart-btn" onclick="addToCart('{{ side.id }}', 'side', '{{ side.name }}', {{ side.price }})">
                            <i class="fas fa-plus"></i>
                            Add to Cart
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Drinks Section -->

{% endblock %}

{% block extra_js %}
<script>
// Search functionality
function searchMenu() {
    const searchTerm = document.getElementById('menu-search').value.toLowerCase();
    const items = document.querySelectorAll('.menu-item');
    
    items.forEach(item => {
        const name = item.querySelector('.item-name').textContent.toLowerCase();
        const description = item.querySelector('.item-description')?.textContent.toLowerCase() || '';
        
        if (name.includes(searchTerm) || description.includes(searchTerm)) {
            item.style.display = 'block';
        } else {
            item.style.display = 'none';
        }
    });
}

// Category filtering
function filterByCategory(category) {
    const items = document.querySelectorAll('.roll-item');
    const categoryBtns = document.querySelectorAll('.category-btn');
    
    // Update active button
    categoryBtns.forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.category === category) {
            btn.classList.add('active');
        }
    });
    
    // Filter items
    items.forEach(item => {
        if (category === 'all' || item.dataset.category === category) {
            item.style.display = 'block';
        } else {
            item.style.display = 'none';
        }
    });
}

// Add to cart functionality
function addToCart(id, type, name, price) {
    fetch('/api/add_to_cart', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            id: id,
            type: type,
            name: name,
            price: price
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Update cart count
            const cartCount = document.getElementById('cart-count');
            if (cartCount) {
                cartCount.textContent = data.cart_count;
            }
            
            // Show success message
            showToast(`${name} added to cart!`, 'success');
        } else {
            showToast('Error adding item to cart', 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showToast('Error adding item to cart', 'error');
    });
}

// Toast notification
function showToast(message, type = 'info') {
    const toast = document.createElement('div');
    toast.className = `toast toast-${type}`;
    toast.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
        <span>${message}</span>
    `;
    
    const container = document.getElementById('toast-container');
    container.appendChild(toast);
    
    setTimeout(() => {
        toast.classList.add('show');
    }, 100);
    
    setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => {
            container.removeChild(toast);
        }, 300);
    }, 3000);
}

// Search on enter key
document.getElementById('menu-search').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        searchMenu();
    }
});
</script>

<style>
/* Hero Section */
.menu-hero {
    background: var(--hero-gradient);
    color: white;
    padding: 4rem 0;
    position: relative;
    overflow: hidden;
    margin-top: 70px; /* Account for fixed navbar */
}

.menu-hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
    animation: backgroundFloat 15s ease-in-out infinite;
}

.hero-content {
    text-align: center;
    position: relative;
    z-index: 2;
}

.hero-title {
    font-size: 3.5rem;
    font-weight: 800;
    margin-bottom: 1rem;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    background: linear-gradient(45deg, #ffffff, #f0f4ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.hero-subtitle {
    font-size: 1.2rem;
    margin-bottom: 2rem;
    opacity: 0.9;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}

.hero-stats {
    display: flex;
    justify-content: center;
    gap: 3rem;
    margin-top: 2rem;
}

.stat-item {
    text-align: center;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 15px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
}

.stat-item:hover {
    background: rgba(255, 255, 255, 0.15);
    transform: translateY(-5px);
    box-shadow: var(--shadow-medium);
}

.stat-number {
    display: block;
    font-size: 2.5rem;
    font-weight: 800;
    color: #ffffff;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

.stat-label {
    font-size: 0.9rem;
    opacity: 0.8;
    margin-top: 0.5rem;
}

/* Filters Section */
.menu-filters {
    background: var(--creamy-white);
    padding: 2rem 0;
    box-shadow: var(--shadow-soft);
    position: sticky;
    top: 70px; /* Account for navbar height */
    z-index: 999; /* Lower than navbar */
    margin-top: 70px; /* Add margin to account for fixed navbar */
    border-bottom: 1px solid rgba(102, 126, 234, 0.1);
}

.filters-wrapper {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.search-box {
    position: relative;
    max-width: 500px;
    margin: 0 auto;
}

.search-box input {
    width: 100%;
    padding: 1rem 3rem 1rem 3rem;
    border: 2px solid rgba(102, 126, 234, 0.2);
    border-radius: 50px;
    font-size: 1rem;
    transition: all 0.3s ease;
    background: white;
    box-shadow: var(--shadow-soft);
}

.search-box input:focus {
    outline: none;
    border-color: var(--primary-purple);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.search-icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--primary-purple);
}

.search-btn {
    position: absolute;
    right: 0.5rem;
    top: 50%;
    transform: translateY(-50%);
    background: var(--button-gradient);
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: var(--shadow-soft);
}

.search-btn:hover {
    background: var(--dark-purple);
    transform: translateY(-50%) scale(1.1);
    box-shadow: var(--shadow-medium);
}

.category-filters {
    display: flex;
    justify-content: center;
    gap: 1rem;
    flex-wrap: wrap;
}

.category-btn {
    padding: 0.75rem 1.5rem;
    border: 2px solid rgba(102, 126, 234, 0.2);
    background: white;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    box-shadow: var(--shadow-soft);
    color: var(--primary-purple);
}

.category-btn:hover {
    border-color: var(--primary-purple);
    color: var(--primary-purple);
    transform: translateY(-2px);
    box-shadow: var(--shadow-medium);
}

.category-btn.active {
    background: var(--button-gradient);
    color: white;
    border-color: var(--primary-purple);
    box-shadow: var(--shadow-medium);
}

/* Menu Sections */
.menu-section {
    padding: 4rem 0;
    position: relative;
}

.menu-section:nth-child(even) {
    background: var(--creamy-white);
}

.menu-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 20% 80%, rgba(102, 126, 234, 0.05) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(118, 75, 162, 0.05) 0%, transparent 50%);
    pointer-events: none;
}

.section-header {
    text-align: center;
    margin-bottom: 3rem;
    position: relative;
    z-index: 2;
}

.section-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--primary-purple);
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    text-shadow: 1px 1px 2px rgba(102, 126, 234, 0.1);
}

.section-title i {
    color: var(--secondary-purple);
    font-size: 2rem;
}

.section-subtitle {
    font-size: 1.1rem;
    color: #666;
    max-width: 600px;
    margin: 0 auto;
    line-height: 1.6;
}

/* Menu Grid */
.menu-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 2rem;
    margin-top: 2rem;
    position: relative;
    z-index: 2;
}

.menu-item {
    background: white;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: var(--shadow-soft);
    transition: all 0.3s ease;
    position: relative;
    border: 1px solid rgba(102, 126, 234, 0.1);
}

.menu-item:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-strong);
    border-color: var(--primary-purple);
}

.item-image-container {
    position: relative;
    height: 200px;
    overflow: hidden;
}

.item-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
}

.menu-item:hover .item-image {
    transform: scale(1.05);
}

.popular-badge {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: var(--button-gradient);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.3rem;
    box-shadow: var(--shadow-soft);
}

.item-content {
    padding: 1.5rem;
}

.item-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 1rem;
}

.item-name {
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--primary-purple);
    margin: 0;
    flex: 1;
}

.item-rating {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.stars {
    display: flex;
    gap: 0.1rem;
}

.stars i {
    color: #ddd;
    font-size: 0.8rem;
}

.stars i.filled {
    color: #ffd93d;
}

.rating-text {
    font-size: 0.9rem;
    color: #666;
    font-weight: 600;
}

.item-description {
    color: #666;
    line-height: 1.6;
    margin-bottom: 1rem;
}

.item-details {
    margin-bottom: 1.5rem;
}

.detail-tags {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
}

.tag {
    padding: 0.3rem 0.8rem;
    border-radius: 15px;
    font-size: 0.8rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 0.3rem;
    box-shadow: var(--shadow-soft);
}

.spicy-tag {
    background: linear-gradient(45deg, #ffe8e8, #fff5f5);
    color: #d63031;
    border: 1px solid rgba(214, 48, 49, 0.2);
}

.calories-tag {
    background: linear-gradient(45deg, #fff3cd, #fff8e1);
    color: #856404;
    border: 1px solid rgba(133, 100, 4, 0.2);
}

.time-tag {
    background: linear-gradient(45deg, #d1ecf1, #e8f4f8);
    color: #0c5460;
    border: 1px solid rgba(12, 84, 96, 0.2);
}

.cold-badge {
    background: linear-gradient(45deg, #e3f2fd, #f3f8ff);
    color: #1976d2;
    padding: 0.3rem 0.8rem;
    border-radius: 15px;
    font-size: 0.8rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 0.3rem;
    border: 1px solid rgba(25, 118, 210, 0.2);
}

.item-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 1rem;
}

.item-price {
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--primary-purple);
    text-shadow: 1px 1px 2px rgba(102, 126, 234, 0.1);
}

.add-to-cart-btn {
    background: var(--button-gradient);
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 25px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    box-shadow: var(--shadow-soft);
}

.add-to-cart-btn:hover {
    background: var(--dark-purple);
    transform: scale(1.05);
    box-shadow: var(--shadow-medium);
}

/* Animated Gradient Background */
.animated-hero-bg {
  background: linear-gradient(120deg, #6a82fb 0%, #fc5c7d 100%);
  background-size: 200% 200%;
  animation: gradientMove 10s ease-in-out infinite;
  position: relative;
  overflow: hidden;
}
@keyframes gradientMove {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* Floating Food Icons */
.floating-foods {
  position: absolute;
  top: 0; left: 0; width: 100%; height: 100%;
  pointer-events: none;
  z-index: 1;
}
.floating-food {
  position: absolute;
  font-size: 2.5rem;
  opacity: 0.18;
  animation: floatFood 8s ease-in-out infinite;
}
.food-1 { left: 10%; top: 20%; animation-delay: 0s; }
.food-2 { left: 80%; top: 30%; animation-delay: 1.5s; }
.food-3 { left: 20%; top: 70%; animation-delay: 3s; }
.food-4 { left: 60%; top: 80%; animation-delay: 4.5s; }
.food-5 { left: 40%; top: 10%; animation-delay: 2s; }
.food-6 { left: 70%; top: 60%; animation-delay: 5.5s; }
@keyframes floatFood {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-30px) scale(1.1); }
}

/* Animated Features Row */
.hero-features {
  display: flex;
  justify-content: center;
  gap: 2rem;
  margin: 2rem 0 1rem 0;
}
.feature-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  color: var(--primary-purple);
  font-weight: 600;
  font-size: 1.1rem;
  background: rgba(255,255,255,0.7);
  border-radius: 12px;
  padding: 1rem 1.5rem;
  box-shadow: var(--shadow-soft);
  transition: all 0.3s;
  opacity: 0;
}
.feature-item i {
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
  color: var(--secondary-purple);
}
.feature-item:hover {
  background: var(--card-gradient);
  color: var(--secondary-purple);
  transform: translateY(-4px) scale(1.05);
  box-shadow: var(--shadow-medium);
}
@keyframes popIn {
  0% { opacity: 0; transform: scale(0.7) translateY(30px);}
  100% { opacity: 1; transform: scale(1) translateY(0);}
}

/* Scroll Indicator */
.scroll-indicator {
  position: absolute;
  left: 50%;
  bottom: 1.5rem;
  transform: translateX(-50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  z-index: 3;
  opacity: 0.85;
}
.scroll-text {
  color: #fff;
  font-size: 1rem;
  margin-bottom: 0.2rem;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
}
.scroll-arrow {
  color: #fff;
  font-size: 1.5rem;
  animation: bounce 1.5s infinite;
}
@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(10px); }
}

/* Animated Bubbles */
.bubbles-bg {
  position: absolute;
  left: 0; top: 0; width: 100%; height: 100%;
  pointer-events: none; z-index: 0;
}
.bubble {
  position: absolute;
  bottom: -60px;
  width: 32px; height: 32px;
  background: rgba(255,255,255,0.13);
  border-radius: 50%;
  animation: bubbleUp 8s linear infinite;
}
@keyframes bubbleUp {
  0% {
    transform: translateY(0) translateX(0) scale(1);
    opacity: 0.7;
  }
  30% {
    opacity: 1;
  }
  50% {
    transform: translateY(-300px) translateX(20px) scale(1.1);
  }
  75% {
    transform: translateY(-500px) translateX(-20px) scale(1.15);
  }
  100% {
    transform: translateY(-600px) translateX(0) scale(1.2);
    opacity: 0;
  }
}

/* Responsive Design */
@media (max-width: 900px) {
  .hero-features {
    flex-direction: column;
    gap: 1rem;
  }
  .hero-title {
    font-size: 2.2rem !important;
  }
}
</style>
{% endblock %}